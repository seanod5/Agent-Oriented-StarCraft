agent TerranCommandCenter {
	module EIS eis;
	module Console C;
	module System S;
	module Prelude P;
	
	types model {
		formula minerals(int);
		formula gas(int);
	}
	
	initial minerals(50);
	initial gas(0);
	initial !init();
	
	rule +!init() {
		eis.join("starcraft");
		eis.link();
		C.println("Command Center online.");
		
		while(true) {
			!deploySCV();
		}
	}
	
	rule +!deploySCV() : minerals(int m) {
		C.println("Minerals: " + m);
		if(m > 50) {
			eis.train("Terran SCV");
			C.println("Deploying SCV");
			list temp = eis.freeEntities();
			S.createAgent(P.headAsString(temp), "TerranSCV");
		}
	}
	
	
	rule +$eis.event(resources(int m, int gas, int CS, int TS)) : minerals(int old) {
		//C.println("Minerals: " + minerals + ", Gas: " + gas);
		-minerals(old);
		+minerals(m);
		+gas(gas);
	}
}