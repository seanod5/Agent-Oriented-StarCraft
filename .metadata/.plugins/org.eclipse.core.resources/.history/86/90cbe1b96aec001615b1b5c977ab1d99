agent TerranCommandCenter {
	module EIS eis;
	module Console C;
	module System S;
	module Prelude P;
	
	types model {
		formula minerals(long);
		formula gas(long);
	}
	
	initial minerals(50);
	initial gas(0);
	initial !init();
	
	rule +!init() {
		eis.join("starcraft");
		eis.link();
		C.println("Command Center online.");
		
		while(true) {
			!deploySCV();
		}
	}
	
//	rule +$eis.event(string entity, unitAmount("TerranSCV", int amount)) : amount > 50 {
//		
//	}
	
	rule +!deploySCV() : minerals(long minerals) {
		C.println("Minerals: " + minerals);
		if(minerals > 50) {
			eis.train("Terran SCV");
			C.println("Deploying SCV");
			list temp = eis.freeEntities();
			S.createAgent(P.headAsString(temp), "TerranSCV");
		}
	}
	
	rule +$eis.event(resources(long minerals, long gas, long CS, long TS)) {
		//C.println("Minerals: " + minerals + ", Gas: " + gas);
		+minerals(minerals);
		+gas(gas);
	}
}